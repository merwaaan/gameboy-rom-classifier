 <!doctype html>
<head>
  <title>Game Boy ROMs</title>
  <meta charset="utf-8">
</head>
<body>

  <header>
    <h1></h1>
    <p>This list contains technical data extracted from GameBoy and GameBoy color ROMs. It is aimed at emulator developers that are looking</p>
  </header>

  <section id="filters">

    <fieldset>
      <legend>MBC</legend>
      <label><input type="checkbox" name="ROM ONLY" checked>ROM ONLY</label>
      <label><input type="checkbox" name="MBC1" checked>MBC1</label>
      <label><input type="checkbox" name="MBC2" checked>MBC2</label>
      <label><input type="checkbox" name="MBC3" checked>MBC3</label>
      <label><input type="checkbox" name="MBC4" checked>MBC4</label>
      <label><input type="checkbox" name="MBC5" checked>MBC5</label>
    </fieldset>

    <fieldset>
      <legend>Specs</legend>
      <label><input type="checkbox" name="RAM" checked>RAM</label>
      <label><input type="checkbox" name="BATTERY" checked>BATTERY</label>
      <label><input type="checkbox" name="TIMER" checked>TIMER</label>
      <label><input type="checkbox" name="RUMBLE" checked>RUMBLE</label>
    </fieldset>

    <fieldset id="categories" style="display: none">
      <legend>Categories</legend>
    </fieldset>

  </section>

  <table>
    <tr>
      <th>Title</th>
      <th>Encoded title</th>
      <th>MBC</th>
      <th>ROM size</th>
      <th>RAM size</th>
      <th>SGB</th>
      <th>Category</th>
    </tr>
  </table>

  <footer>
    <p>Generated with <a href="http://github.com/merwaaan/gameboy-rom-classifier">this script</a></p>
  </footer>

  <script>

    // Initialization

    var rows = [];

    var filter = {
      'ROM ONLY': true,
      MBC1: true,
      MBC2: true,
      MBC3: true,
      MBC4: true,
      MBC5: true,
      RAM: true,
      BATTERY: true,
      TIMER: true,
      RUMBLE: true
    }

    var rows_dom = document.querySelectorAll('tr');
    for (var r = 1; r < rows_dom.length; ++r) {

      // Cache all rows
      rows.push({
        row_element: rows_dom[r],
        mbc_element: rows_dom[r].querySelector('td:nth-child(3)'),
        cat_element: rows_dom[r].querySelector('td:nth-child(7)')
      });

      // Add checkboxes for the categories
      var category = rows[rows.length-1].cat_element.innerHTML;
      if (category !== '' && filter[category] === undefined) {

        filter[category] = true;

        var input = document.createElement('input');
        input.type = 'checkbox';
        input.name = category;
        input.value = category;
        input.checked = true;
        var label = document.createElement('label');
        label.textContent = category; // TODO fix position (should be right of cb)
        label.appendChild(input);
        var fieldset = document.querySelector('fieldset#categories');
        fieldset.appendChild(label);
        fieldset.style.display = 'inline-block';
      }
    }

    // Filtering

    var criteria = Object.keys(filter);

    for (var i in criteria)
      document.querySelector('input[name="'+criteria[i]+'"]').addEventListener('change', function(event) {
        update(event.target.name, event.target.checked);
      });

    function update(criterion, on) {
      filter[criterion] = on; // Update filter
      for (var i in rows) // Update view
        rows[i].row_element.style.display = filtered(rows[i]) ? 'none' : 'table-row';
    }

    function filtered(row) {
      for (var i = 0; i < 10; ++i)
        if (filter[criteria[i]] == false && row.mbc_element.innerHTML.indexOf(criteria[i]) > -1)
          return true;
      for (var i = 10; i < criteria.length; ++i)
        if (filter[criteria[i]] == false && row.cat_element.innerHTML == criteria[i])
          return true;
      return false;
    }

  </script>

  <style type="text/css">
    body {
      font-family: monospace;
    }
    section#filters {
      margin-bottom: 0.5em;
    }
    fieldset {
      display: inline-block;
    }
    table {
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid black;
    }
  </style>

</body>
</html>